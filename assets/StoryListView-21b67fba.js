import{i as T,g as x,s as L,r as M,o as r,c as l,a as t,b as S,w as D,d as C,y as h,J as y,F as f,j as v,u as F,t as p,k as O,m as P,p as R,e as j}from"./index-5bfc36e7.js";import{u as z,s as A,e as J,r as q,P as I,p as G}from"./experience-bf1ef0c0.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";const u=k=>(R("data-v-1c245b74"),k=k(),j(),k),K={class:"page"},Q={class:"header"},X=u(()=>t("h1",{class:"title"},"听枫馆打卡记录",-1)),Y={class:"filter-section"},Z=u(()=>t("option",{value:1},"显示玩过的",-1)),ee=u(()=>t("option",{value:0},"隐藏玩过的",-1)),te=[Z,ee],se=u(()=>t("option",{value:1},"显示入门模组",-1)),oe=u(()=>t("option",{value:0},"隐藏入门模组",-1)),ne=[se,oe],ae={class:"filter-multi-container filter-of-period"},ie=u(()=>t("option",{value:"",disabled:"",selected:""},"选择时长",-1)),re=u(()=>t("option",{value:"",hidden:""},"重置",-1)),le=["value"],ce={class:"filter-multi-values"},de=u(()=>t("option",{value:""},"全年代",-1)),ue=u(()=>t("option",{value:"20"},"2000+",-1)),pe=u(()=>t("option",{value:"19"},"1900+",-1)),_e=[de,ue,pe],me=u(()=>t("option",{value:""},"全世界",-1)),fe=["value"],ve={class:"list"},he={class:"item-mark"},ye=["checked"],ke={class:"item-name"},we={key:0,class:"prefer-label"},be={key:1,class:"item-comments-container"},ge=u(()=>t("div",{class:"item-comments-icon"},"📝",-1)),Ve={class:"item-comments-panel"},xe={class:"item-decade"},Le={class:"item-areas"},Se=T({__name:"StoryListView",setup(k){z("dark");function N(){return n=>{const{name:o}=n,d=J.get(o),e=q.get(o);return{story:n,experience:d,record:e}}}const w=["short","medium","long","battle"];function U(n){const o=[(e,s)=>{var a,i;return Number(((a=s.record)==null?void 0:a.isPlayed)||!1)-Number(((i=e.record)==null?void 0:i.isPlayed)||!1)},(e,s)=>{var a,i;return(((a=s.record)==null?void 0:a.prefer)||0)-(((i=e.record)==null?void 0:i.prefer)||0)},(e,s)=>w.indexOf(e.story.period)-w.indexOf(s.story.period),(e,s)=>{const a=e.story.decade.decade,i=s.story.decade.decade;if(!i)return-1;if(!a)return 1;if(a!==i)return a>i?1:-1;const m=e.story.decade.decadeInt,_=s.story.decade.decadeInt;return _?m?m-_:1:-1},(e,s)=>{const a=e.story.area[0].country,i=s.story.area[0].country;return a!==i?a>i?-1:1:(e.story.area[0].city||"")>(s.story.area[0].city||"")?-1:1}],d=[...n].filter(e=>{var s;return!((s=e.story.options)!=null&&s.inactive)}).filter(e=>{var s;return!((s=e.story.options)!=null&&s.removed)});return o.reverse().forEach(e=>d.sort(e)),d}const V=U([...A.map(N())]),W=w.map(n=>[n,G[n]]),$=x(()=>{const n=new Map;return V.forEach(o=>{o.story.area.forEach(d=>{n.set(d.country,(n.get(d.country)||0)+1)})}),[...n.entries()].sort((o,d)=>d[1]-o[1])}),c=L({showPlayed:1,showWelcome:1,period:new Set,decade:"",country:""}),b=L("");function B(n){n&&!c.value.period.has(n)&&c.value.period.add(n),b.value=""}const E=x(()=>V.filter(({story:n,record:o})=>{var m,_;const{showPlayed:d,showWelcome:e,period:s,decade:a,country:i}=c.value;return!(!d&&(o!=null&&o.isPlayed)||!e&&((m=n.options)!=null&&m.welcome)||s.size>0&&!s.has(n.period)||a&&!((_=n.decade.decade)!=null&&_.startsWith(a))||i&&!n.area.some(g=>g.country===i))}));return(n,o)=>{const d=M("RouterLink");return r(),l("main",K,[t("div",Q,[X,S(d,{class:"link",to:"/self"},{default:D(()=>[C("我的记录")]),_:1})]),t("div",Y,[h(t("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>c.value.showPlayed=e),class:"filter-control"},te,512),[[y,c.value.showPlayed]]),h(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>c.value.showWelcome=e),class:"filter-control"},ne,512),[[y,c.value.showWelcome]]),t("div",ae,[h(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>b.value=e),onChange:o[3]||(o[3]=e=>B(b.value)),class:"filter-control"},[ie,re,(r(!0),l(f,null,v(F(W),e=>(r(),l("option",{key:e[0],value:e[0]},p(e[1]),9,le))),128))],544),[[y,b.value]]),t("div",ce,[(r(!0),l(f,null,v(w.filter(e=>c.value.period.has(e)),e=>(r(),O(I,{key:e,class:"period-label-filter-value",period:e,onClick:s=>c.value.period.delete(e)},null,8,["period","onClick"]))),128))])]),h(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>c.value.decade=e),class:"filter-control"},_e,512),[[y,c.value.decade]]),h(t("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>c.value.country=e),class:"filter-control"},[me,(r(!0),l(f,null,v($.value,e=>(r(),l("option",{key:e[0],value:e[0]}," 仅"+p(e[0])+" ("+p(e[1])+") ",9,fe))),128))],512),[[y,c.value.country]])]),t("div",ve,[(r(!0),l(f,null,v(E.value,({story:e,record:s,experience:a})=>{var i,m;return r(),l("div",{class:"item",key:e.name},[t("div",he,[t("input",{type:"checkbox",checked:s==null?void 0:s.isPlayed},null,8,ye)]),t("div",ke,[S(I,{period:e.period,welcome:(i=e.options)==null?void 0:i.welcome},null,8,["period","welcome"]),t("span",null,p(e.name)+p((m=e.options)!=null&&m.store?` (${e.options.store})`:""),1),s!=null&&s.prefer?(r(),l("span",we,[(r(!0),l(f,null,v(Array.from({length:s.prefer}),(_,g)=>(r(),l("span",{key:g},"♡"))),128))])):P("",!0),a?(r(),l("div",be,[ge,t("div",Ve,[t("div",null,[t("span",null,"模组"+p(a.storyScore)+"分/体验"+p(a.experienceScore)+"分",1),C(p(" ")+" "),t("span",null,p(a.comments),1)])])])):P("",!0)]),t("div",xe,p(e.decade.decadeText),1),t("div",Le,[(r(!0),l(f,null,v(e.area,_=>(r(),l("span",{class:"area-info",key:_.city},p(`${_.country}${_.city??""}`),1))),128))])])}),128))])])}}});const Ne=H(Se,[["__scopeId","data-v-1c245b74"]]);export{Ne as default};
