import{d as T,x as M,h as L,A as j,b as C,o as v,c as b,a,t as k,y as $,F as y,r as w,s as u,w as d,v as g,e as R,C as U,a5 as A,a4 as B,p as O,f as F}from"./index-D_4YsHX2.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ft(n){for(let s=n.length-1;s>0;s--){const l=Math.floor(Math.random()*(s+1));[n[s],n[l]]=[n[l],n[s]]}return n}function E(n,s=1){return Array.from({length:s}).reduce(l=>{const i=Math.floor(Math.random()*n)+1;return l+i},0)}function N(n,s){const l=s.toString().length,i=n.toString();return i+Array.from({length:l-i.length}).map(t=>" ").join("")}function G(n){const s={dice:Number(n.dice),times:Number(n.times),pick:Number(n.pick||n.times),plus:Number(n.plus??0),align:n.align},{dice:l,times:i,pick:t=i,plus:f=0,align:c=!0}=s,r=t?Math.min(Math.abs(t),i):i,e=Array.from({length:i}).map(()=>Math.floor(Math.random()*l)+1),m=i-r,_=[...e],x=[];for(let p=0;p<m;p++){const o=_.indexOf(Math[t>0?"min":"max"](...e));x.push(..._.splice(o,1))}const h=_.reduce((p,o)=>p+o,f),D=l*r+f,V=[`${c?N(h,D):h} =`,m?`(${e.map(p=>`${c?N(p,l):p}`).join(",")})`:"",_.join(" + "),f?`(+ ${f})`:""].filter(p=>p).join(" ");return{result:h,text:V,detail:e,detailUsed:_,detailRemoved:x}}function I(n="",s,l){const i={dice:Number(l.dice),times:Number(l.times),pick:Number(l.pick),plus:Number(l.plus??0)},{times:t,dice:f,pick:c,plus:r}=i;return[n?`${n}的`:"",`${s}次`,[`${t}d`,f,c?`p${c}`:"",r?` + ${r}`:""].join("")].filter(e=>e).join(" ")}function q(n,s,l){const i=Array.from({length:n}).map(()=>G(s)),{sort:t="desc"}=l||{};return t&&i.sort((c,r)=>t==="asc"?c.result-r.result:r.result-c.result),{text:i.map(c=>c.text).join(`
`),details:i}}const S=n=>(O("data-v-c9ea2d0b"),n=n(),F(),n),H={class:"container"},J={class:"result-section"},K=S(()=>a("div",{class:"result-section-title"},"投掷结果：",-1)),P={class:"result-cards"},Q={key:0,class:"result-card"},W={class:"result-card-title"},X={class:"result-card-content"},Y={key:0,class:"result-section-title"},Z={class:"result-cards"},tt={class:"result-card-time"},et={class:"result-card-title"},ot={class:"result-card-content"},nt={class:"action-card"},lt=S(()=>a("div",{class:"action-card-title"},"简单投掷（点击即骰）",-1)),st={class:"simple-dice-container"},it={key:0,class:"action-card"},ut={class:"action-card-title"},rt={class:"action-card-row"},at={class:"action-card-row"},dt={class:"action-card-row"},ct=T({__name:"RollTool",props:{hideDiy:{type:Boolean}},setup(n){const s=[2,3,4,6,8,10,12,20,100],l=M([]),i=L(()=>l.value[0]),t=j({groupCount:5,options:{dice:6,times:3},diceListIndex:3,onDiceListIndexChange(r){t.diceListIndex=(t.diceListIndex+r+s.length)%s.length},onRoll(){const r=q(this.groupCount,this.options).text;l.value=[{title:I("",this.groupCount,this.options),content:r,time:new Date().toLocaleTimeString(),timestamp:Date.now()},...l.value]}}),f=L(()=>I("",t.groupCount,t.options));function c(r){const e=E(r);l.value=[{title:`D${r} = ${e}`,time:new Date().toLocaleTimeString(),timestamp:Date.now()},...l.value]}return(r,e)=>{const m=C("el-button"),_=C("el-input"),x=C("el-button-group"),h=C("el-form-item"),D=C("el-radio-button"),V=C("el-radio-group"),p=C("el-form");return v(),b("div",H,[a("div",J,[K,a("div",P,[i.value?(v(),b("div",Q,[a("div",W,k(i.value.title),1),a("div",X,k(i.value.content),1)])):$("",!0)]),l.value.length>1?(v(),b("div",Y," 历史投掷结果： ")):$("",!0),a("div",Z,[(v(!0),b(y,null,w(l.value.slice(1),o=>(v(),b("div",{class:"result-card",key:o.timestamp},[a("div",tt,k(o.time),1),a("div",et,k(o.title),1),a("div",ot,k(o.content),1)]))),128))])]),a("div",nt,[lt,a("div",st,[(v(),b(y,null,w(s,o=>a("div",{key:o},[u(m,{onClick:mt=>c(o)},{default:d(()=>[g(" D"+k(o),1)]),_:2},1032,["onClick"])])),64))])]),r.hideDiy?$("",!0):(v(),b("div",it,[a("div",ut,"自定义投掷（当前："+k(f.value)+"）",1),u(p,{"label-width":"auto",model:t,onSubmit:e[13]||(e[13]=B(()=>t.onRoll(),["prevent"]))},{default:d(()=>[u(h,{label:"几组"},{default:d(()=>[a("div",rt,[u(_,{class:"col-1",type:"number",modelValue:t.groupCount,"onUpdate:modelValue":e[0]||(e[0]=o=>t.groupCount=o),min:1},null,8,["modelValue"]),u(x,{modelValue:t.groupCount,"onUpdate:modelValue":e[5]||(e[5]=o=>t.groupCount=o)},{default:d(()=>[u(m,{onClick:e[1]||(e[1]=o=>t.groupCount=1)},{default:d(()=>[g(" 1 ")]),_:1}),u(m,{onClick:e[2]||(e[2]=o=>t.groupCount=5)},{default:d(()=>[g(" 5 ")]),_:1}),u(m,{onClick:e[3]||(e[3]=o=>t.groupCount-=1)},{default:d(()=>[g(" -1 ")]),_:1}),u(m,{onClick:e[4]||(e[4]=o=>t.groupCount+=1)},{default:d(()=>[g(" +1 ")]),_:1})]),_:1},8,["modelValue"])])]),_:1}),u(h,{label:"D"},{default:d(()=>[a("div",at,[u(m,{onClick:e[6]||(e[6]=o=>t.onDiceListIndexChange(-3))},{default:d(()=>[g(" ← ")]),_:1}),u(V,{modelValue:t.options.dice,"onUpdate:modelValue":e[7]||(e[7]=o=>t.options.dice=o)},{default:d(()=>[(v(!0),b(y,null,w(s.slice(t.diceListIndex,t.diceListIndex+3),o=>(v(),R(D,{key:o,label:`D${o}`,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),u(m,{onClick:e[8]||(e[8]=o=>t.onDiceListIndexChange(3))},{default:d(()=>[g(" → ")]),_:1})])]),_:1}),u(h,{label:"几颗"},{default:d(()=>[a("div",dt,[u(_,{type:"number",modelValue:t.options.times,"onUpdate:modelValue":e[10]||(e[10]=o=>t.options.times=o),min:1},{append:d(()=>[u(m,{icon:U(A),onClick:e[9]||(e[9]=o=>t.options.times=1)},null,8,["icon"])]),_:1},8,["modelValue"]),g(" 选 "),u(_,{type:"number",placeholder:"几颗最 +大/-小 的",modelValue:t.options.pick,"onUpdate:modelValue":e[11]||(e[11]=o=>t.options.pick=Number(o))},null,8,["modelValue"])])]),_:1}),u(h,{label:"加值"},{default:d(()=>[u(_,{type:"number",modelValue:t.options.plus,"onUpdate:modelValue":e[12]||(e[12]=o=>t.options.plus=o)},null,8,["modelValue"])]),_:1}),u(m,{type:"default",size:"large",nativeType:"submit"},{default:d(()=>[g(" 投掷 ")]),_:1})]),_:1},8,["model"])]))])}}}),vt=z(ct,[["__scopeId","data-v-c9ea2d0b"]]);export{vt as R,ft as s};
