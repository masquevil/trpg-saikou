import{k as E,j as L,s as C,r as M,o as i,c as l,a as t,b as V,w as T,d as z,B as y,Z as k,F as f,z as v,x as D,t as _,l as F,u as g,p as O,e as R}from"./index-BrwjisMT.js";import{s as j,e as A,r as Z,P,p as q}from"./record-D7WEX8Xf.js";import{S as G}from"./SoxCheckbox-Dv9HHeBN.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const u=w=>(O("data-v-e777a3d1"),w=w(),R(),w),J={class:"page"},K={class:"header"},Q=u(()=>t("h1",{class:"title"},"听枫馆打卡记录",-1)),X={class:"filter-section"},Y=u(()=>t("option",{value:1},"显示玩过的",-1)),ee=u(()=>t("option",{value:0},"隐藏玩过的",-1)),te=[Y,ee],se=u(()=>t("option",{value:1},"显示入门模组",-1)),oe=u(()=>t("option",{value:0},"隐藏入门模组",-1)),ne=[se,oe],ae={class:"filter-multi-container filter-of-period"},re=u(()=>t("option",{value:"",disabled:"",selected:""}," 选择时长 ",-1)),ie=u(()=>t("option",{value:"",hidden:""}," 重置 ",-1)),le=["value"],de={class:"filter-multi-values"},ce=u(()=>t("option",{value:""},"全年代",-1)),ue=u(()=>t("option",{value:"20"},"2000+",-1)),pe=u(()=>t("option",{value:"19"},"1900+",-1)),_e=[ce,ue,pe],me=u(()=>t("option",{value:""},"全世界",-1)),fe=["value"],ve={class:"list"},he={class:"item-mark"},ye={class:"item-name"},ke={key:0,class:"prefer-label"},we={key:1,class:"item-comments-container"},xe=u(()=>t("div",{class:"item-comments-icon"},"📝",-1)),Se={class:"item-comments-panel"},Ve={class:"item-decade"},ge={class:"item-areas"},be={key:0},Le={class:"area-info"},Ce=E({__name:"StoryListView",setup(w){function I(){return n=>{const{name:o}=n,c=A.get(o),e=Z.get(o);return{story:n,experience:c,record:e}}}const x=["short","medium","long","battle"];function N(n){const o=[(e,s)=>{var a,r;return Number(((a=s.record)==null?void 0:a.isPlayed)||!1)-Number(((r=e.record)==null?void 0:r.isPlayed)||!1)},(e,s)=>{var a,r;return(((a=s.record)==null?void 0:a.prefer)||0)-(((r=e.record)==null?void 0:r.prefer)||0)},(e,s)=>x.indexOf(e.story.period)-x.indexOf(s.story.period),(e,s)=>{const a=e.story.decade.decade,r=s.story.decade.decade;if(!r)return-1;if(!a)return 1;if(a!==r)return a>r?1:-1;const m=e.story.decade.decadeInt,p=s.story.decade.decadeInt;return p?m?m-p:1:-1},(e,s)=>{const a=e.story.area[0].country,r=s.story.area[0].country;return a!==r?a>r?-1:1:(e.story.area[0].city||"")>(s.story.area[0].city||"")?-1:1}],c=[...n].filter(e=>{var s;return!((s=e.story.options)!=null&&s.inactive)}).filter(e=>{var s;return!((s=e.story.options)!=null&&s.removed)});return o.reverse().forEach(e=>c.sort(e)),c}const b=N([...j.map(I())]),B=x.map(n=>[n,q[n]]),U=L(()=>{const n=new Map;return b.forEach(o=>{o.story.area.forEach(c=>{n.set(c.country,(n.get(c.country)||0)+1)})}),[...n.entries()].sort((o,c)=>c[1]-o[1])}),d=C({showPlayed:1,showWelcome:1,period:new Set,decade:"",country:""}),S=C("");function W(n){n&&!d.value.period.has(n)&&d.value.period.add(n),S.value=""}const $=L(()=>b.filter(({story:n,record:o})=>{var m,p;const{showPlayed:c,showWelcome:e,period:s,decade:a,country:r}=d.value;return!(!c&&(o!=null&&o.isPlayed)||!e&&((m=n.options)!=null&&m.welcome)||s.size>0&&!s.has(n.period)||a&&!((p=n.decade.decade)!=null&&p.startsWith(a))||r&&!n.area.some(h=>h.country===r))}));return(n,o)=>{const c=M("RouterLink");return i(),l("main",J,[t("div",K,[Q,V(c,{class:"link",to:"/self"},{default:T(()=>[z(" 我的记录 ")]),_:1})]),t("div",X,[y(t("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>d.value.showPlayed=e),class:"filter-control"},te,512),[[k,d.value.showPlayed]]),y(t("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>d.value.showWelcome=e),class:"filter-control"},ne,512),[[k,d.value.showWelcome]]),t("div",ae,[y(t("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>S.value=e),onChange:o[3]||(o[3]=e=>W(S.value)),class:"filter-control"},[re,ie,(i(!0),l(f,null,v(D(B),e=>(i(),l("option",{key:e[0],value:e[0]},_(e[1]),9,le))),128))],544),[[k,S.value]]),t("div",de,[(i(!0),l(f,null,v(x.filter(e=>d.value.period.has(e)),e=>(i(),F(P,{key:e,class:"period-label-filter-value",period:e,onClick:s=>d.value.period.delete(e)},null,8,["period","onClick"]))),128))])]),y(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>d.value.decade=e),class:"filter-control"},_e,512),[[k,d.value.decade]]),y(t("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>d.value.country=e),class:"filter-control"},[me,(i(!0),l(f,null,v(U.value,e=>(i(),l("option",{key:e[0],value:e[0]}," 仅"+_(e[0])+" ("+_(e[1])+") ",9,fe))),128))],512),[[k,d.value.country]])]),t("div",ve,[(i(!0),l(f,null,v($.value,({story:e,record:s,experience:a})=>{var r,m;return i(),l("div",{class:"item",key:e.name},[t("div",he,[V(G,{checked:s==null?void 0:s.isPlayed},null,8,["checked"])]),t("div",ye,[V(P,{period:e.period,welcome:(r=e.options)==null?void 0:r.welcome},null,8,["period","welcome"]),t("span",null,_(e.name)+" "+_((m=e.options)!=null&&m.store?` (${e.options.store})`:""),1),s!=null&&s.prefer?(i(),l("span",ke,[(i(!0),l(f,null,v(Array.from({length:s.prefer}),(p,h)=>(i(),l("span",{key:h},"♡"))),128))])):g("",!0),a?(i(),l("div",we,[xe,t("div",Se,[t("div",null,[t("span",null," 模组"+_(a.storyScore)+"分/体验"+_(a.experienceScore)+"分 ",1),t("span",null,_(a.comments),1)])])])):g("",!0)]),t("div",Ve,_(e.decade.decadeText),1),t("div",ge,[(i(!0),l(f,null,v(e.area,(p,h)=>(i(),l(f,{key:p.city},[h?(i(),l("span",be," / ")):g("",!0),t("span",Le,_(`${p.country}${p.city??""}`),1)],64))),128))])])}),128))])])}}}),Ue=H(Ce,[["__scopeId","data-v-e777a3d1"]]);export{Ue as default};
